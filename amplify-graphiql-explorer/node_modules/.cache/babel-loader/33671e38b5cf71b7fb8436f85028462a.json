{"ast":null,"code":"import _toConsumableArray from\"/home/katesclau/returnmates/amplify-appsync-simulator/amplify-graphiql-explorer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/katesclau/returnmates/amplify-appsync-simulator/amplify-graphiql-explorer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/katesclau/returnmates/amplify-appsync-simulator/amplify-graphiql-explorer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/katesclau/returnmates/amplify-appsync-simulator/amplify-graphiql-explorer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/katesclau/returnmates/amplify-appsync-simulator/amplify-graphiql-explorer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/katesclau/returnmates/amplify-appsync-simulator/amplify-graphiql-explorer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/katesclau/returnmates/amplify-appsync-simulator/amplify-graphiql-explorer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/katesclau/returnmates/amplify-appsync-simulator/amplify-graphiql-explorer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _objectSpread from\"/home/katesclau/returnmates/amplify-appsync-simulator/amplify-graphiql-explorer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import GraphiQL from'graphiql';import GraphiQLExplorer from'graphiql-explorer';import'graphiql/graphiql.css';import{buildClientSchema,getIntrospectionQuery,parse}from'graphql';import React,{Component}from'react';import'semantic-ui-css/semantic.min.css';import'./App.css';import{AuthModal,AUTH_MODE}from'./AuthModal';import{refreshToken}from'./utils/jwt';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var DEFAULT_COGNITO_JWT_TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI3ZDhjYTUyOC00OTMxLTQyNTQtOTI3My1lYTVlZTg1M2YyNzEiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiaXNzIjoiaHR0cHM6Ly9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbS91cy1lYXN0LTFfZmFrZSIsInBob25lX251bWJlcl92ZXJpZmllZCI6dHJ1ZSwiY29nbml0bzp1c2VybmFtZSI6InVzZXIxIiwiYXVkIjoiMmhpZmEwOTZiM2EyNG12bTNwaHNrdWFxaTMiLCJldmVudF9pZCI6ImIxMmEzZTJmLTdhMzYtNDkzYy04NWIzLTIwZDgxOGJkNzhhMSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxOTc0MjY0NDEyLCJwaG9uZV9udW1iZXIiOiIrMTIwNjIwNjIwMTYiLCJleHAiOjE1NjQyNjgwMTIsImlhdCI6MTU2NDI2NDQxMywiZW1haWwiOiJ1c2VyQGRvbWFpbi5jb20ifQ.wHKY2KIhvWn4zpJ4TZ1vS3zRE9mGWsLY4NCV2Cof17Q\";var DEFAULT_OIDC_JWT_TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJpc3MiOiJodHRwczovL3NvbWUtb2lkYy1wcm92aWRlci9hdXRoIiwicGhvbmVfbnVtYmVyX3ZlcmlmaWVkIjp0cnVlLCJhdWQiOiIyaGlmYTA5NmIzYTI0bXZtM3Boc2t1YXFpMyIsImV2ZW50X2lkIjoiYjEyYTNlMmYtN2EzNi00OTNjLTg1YjMtMjBkODE4YmQ3OGExIiwidG9rZW5fdXNlIjoiaWQiLCJhdXRoX3RpbWUiOjE5NzQyNjQ0MTIsInBob25lX251bWJlciI6IisxMjA2MjA2MjAxNiIsImV4cCI6MTU2NDI2ODAxMiwiaWF0IjoxNTY0MjY0NDEzLCJlbWFpbCI6InVzZXJAZG9tYWluLmNvbSJ9.uAegFXomOnA7Dkl-5FcS5icu5kL9Juqb81GnTrOZZqM\";var AUTH_TYPE_TO_NAME={AMAZON_COGNITO_USER_POOLS:'User Pool',API_KEY:'API Key',OPENID_CONNECT:'Open ID',AWS_IAM:'IAM'};var DEFAULT_API_INFO={name:'AppSyncTransformer',defaultAuthenticationType:{authenticationType:'API_KEY'},additionalAuthenticationProviders:[],apiKey:'da2-fakeApiId123456'};var LOCAL_STORAGE_KEY_NAMES={cognitoToken:'AMPLIFY_GRPAHIQL_EXPLORER_COGNITO_JWT_TOKEN',oidcToken:'AMPLIFY_GRPAHIQL_EXPLORER_OIDC_JWT_TOKEN',apiKey:'AMPLIFY_GRPAHIQL_EXPLORER_API_KEY',iam:'AMPLIFY_GRPAHIQL_EXPLORER_AWS_IAM'};function getAPIInfo(){return fetch('/api-config').then(function(response){return response.json();});}function fetcher(params,additionalHeaders){var headers=_objectSpread({Accept:'application/json','Content-Type':'application/json'},additionalHeaders);return fetch('/graphql',{method:'POST',headers:headers,body:JSON.stringify(params)}).then(function(response){return response.json();}).then(function(responseBody){try{return JSON.parse(responseBody);}catch(e){return responseBody;}});}var DEFAULT_QUERY=\"# shift-option/alt-click on a query below to jump to it in the explorer\\n# option/alt-click on a field in the explorer to select all subfields\\n\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this._graphiql=void 0;_this.state={schema:null,query:DEFAULT_QUERY,explorerIsOpen:true,authModalVisible:false,apiInfo:DEFAULT_API_INFO,currentAuthMode:AUTH_MODE.API_KEY,credentials:{apiKey:'',cognitoJWTToken:'',oidcJWTToken:'',iam:''}};_this.toggleAuthModal=function(){return _this.setState(function(prevState){return{authModalVisible:!prevState.authModalVisible};});};_this.switchAuthMode=function(val){_this.setState({currentAuthMode:val});};_this._handleInspectOperation=function(cm,mousePos){var parsedQuery=parse(_this.state.query||'');if(!parsedQuery){console.error(\"Couldn't parse query document\");return null;}var token=cm.getTokenAt(mousePos);var start={line:mousePos.line,ch:token.start};var end={line:mousePos.line,ch:token.end};var relevantMousePos={start:cm.indexFromPos(start),end:cm.indexFromPos(end)};var position=relevantMousePos;var def=parsedQuery.definitions.find(function(definition){if(!definition.loc){console.log('Missing location information for definition');return false;}var _definition$loc=definition.loc,start=_definition$loc.start,end=_definition$loc.end;return start<=position.start&&end>=position.end;});if(!def){console.error(\"Unable to find definition corresponding position at \".concat(position.start));return null;}var operationKind=def.kind==='OperationDefinition'?def.operation:def.kind==='FragmentDefinition'?'fragment':'unknown';var operationName=def.kind==='OperationDefinition'&&!!def.name?def.name.value:def.kind==='FragmentDefinition'&&!!def.name?def.name.value:'unknown';var selector=\".graphiql-explorer-root #\".concat(operationKind,\"-\").concat(operationName);var el=document.querySelector(selector);el&&el.scrollIntoView();};_this._handleEditQuery=function(query){return _this.setState({query:query});};_this._handleToggleExplorer=function(){_this.setState({explorerIsOpen:!_this.state.explorerIsOpen});};_this.fetch=_this.fetch.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$_graphiql;var apiInfo,introspectionResult,editor;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getAPIInfo();case 2:apiInfo=_context.sent;this.loadCredentials(apiInfo);this.setState({apiInfo:apiInfo});_context.next=7;return this.fetch({query:getIntrospectionQuery()});case 7:introspectionResult=_context.sent;editor=(_this$_graphiql=this._graphiql)===null||_this$_graphiql===void 0?void 0:_this$_graphiql.getQueryEditor();editor.setOption('extraKeys',_objectSpread(_objectSpread({},editor.options.extraKeys||{}),{},{'Shift-Alt-LeftClick':this._handleInspectOperation}));if(introspectionResult&&introspectionResult.data){this.setState({schema:buildClientSchema(introspectionResult.data)});}case 11:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"fetch\",value:function fetch(params){var headers={};if(this.state.currentAuthMode===AUTH_MODE.API_KEY){headers['x-api-key']=this.state.credentials.apiKey;}else if(this.state.currentAuthMode===AUTH_MODE.AMAZON_COGNITO_USER_POOLS){headers['Authorization']=this.state.credentials.cognitoJWTToken;}else if(this.state.currentAuthMode===AUTH_MODE.OPENID_CONNECT){headers['Authorization']=this.state.credentials.oidcJWTToken;}else if(this.state.currentAuthMode===AUTH_MODE.AWS_IAM){headers['Authorization']=this.state.credentials.iam;}return fetcher(params,headers);}},{key:\"storeCredentials\",value:function storeCredentials(credentials){var apiInfo=this.state.apiInfo;var newState={apiInfo:_objectSpread(_objectSpread({},apiInfo),{},{authenticationType:credentials.authMode})};if(credentials.authMode==='API_KEY'){newState['apiKey']=credentials.apiKey;window.localStorage.setItem(LOCAL_STORAGE_KEY_NAMES.apiKey,credentials.apiKey);}else if(credentials.authMode===AUTH_MODE.AMAZON_COGNITO_USER_POOLS){newState['cognitoJWTToken']=credentials.cognitoToken;window.localStorage.setItem(LOCAL_STORAGE_KEY_NAMES.cognitoToken,credentials.cognitoToken);}else if(credentials.authMode===AUTH_MODE.OPENID_CONNECT){newState['oidcJWTToken']=credentials.OIDCToken;window.localStorage.setItem(LOCAL_STORAGE_KEY_NAMES.oidcToken,credentials.OIDCToken);}else if(credentials.authMode===AUTH_MODE.AWS_IAM){newState['oidcJWTToken']=credentials.IAM;window.localStorage.setItem(LOCAL_STORAGE_KEY_NAMES.iam,credentials.iam);}this.setState(function(prevState){return{credentials:_objectSpread(_objectSpread({},prevState.credentials),newState),currentAuthMode:credentials.authMode};});}},{key:\"loadCredentials\",value:function loadCredentials(){var apiInfo=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.state.apiInfo;var credentials={};var authProviders=[apiInfo.defaultAuthenticationType].concat(_toConsumableArray(apiInfo.additionalAuthenticationProviders));var possibleAuth=authProviders.map(function(auth){return auth.authenticationType;});if(possibleAuth.includes('API_KEY')){credentials['apiKey']=DEFAULT_API_INFO.apiKey;}if(possibleAuth.includes('AMAZON_COGNITO_USER_POOLS')){try{credentials['cognitoJWTToken']=refreshToken(window.localStorage.getItem(LOCAL_STORAGE_KEY_NAMES.cognitoToken)||'');}catch(e){console.warn('Invalid Cognito token found in local storage. Using the default OIDC token');// token is not valid\ncredentials['cognitoJWTToken']=refreshToken(DEFAULT_COGNITO_JWT_TOKEN);}}if(possibleAuth.includes('OPENID_CONNECT')){var issuers=authProviders.filter(function(auth){return auth.authenticationType===AUTH_MODE.OPENID_CONNECT;}).map(function(auth){return auth.openIDConnectConfig.Issuer;});try{credentials['oidcJWTToken']=refreshToken(window.localStorage.getItem(LOCAL_STORAGE_KEY_NAMES.oidcToken)||'',issuers[0]);}catch(e){console.warn('Invalid OIDC token found in local storage. Using the default OIDC token');credentials['oidcJWTToken']=refreshToken(DEFAULT_OIDC_JWT_TOKEN,issuers[0]);}}if(possibleAuth.includes('AWS_IAM')){credentials['iam']='AWS4-HMAC-SHA256 IAMAuthorized';}this.setState(function(){return{currentAuthMode:AUTH_MODE[apiInfo.defaultAuthenticationType.authenticationType]||AUTH_MODE.API_KEY};});this.setState({credentials:credentials});return credentials;}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,query=_this$state.query,schema=_this$state.schema,authModalVisible=_this$state.authModalVisible,apiInfo=_this$state.apiInfo;var authModes=[AUTH_MODE[apiInfo.defaultAuthenticationType.authenticationType]].concat(_toConsumableArray(apiInfo.additionalAuthenticationProviders.map(function(auth){return AUTH_MODE[auth.authenticationType];}))).filter(function(auth){return auth;});var authModal=authModalVisible?/*#__PURE__*/_jsx(AuthModal,{selectedAuthMode:this.state.currentAuthMode,currentOIDCToken:this.state.credentials.oidcJWTToken,currentCognitoToken:this.state.credentials.cognitoJWTToken,apiKey:this.state.credentials.apiKey,authModes:authModes,onClose:function onClose(credentials){_this2.storeCredentials(credentials);_this2.setState({authModalVisible:false});}}):null;return/*#__PURE__*/_jsxs(_Fragment,{children:[authModal,/*#__PURE__*/_jsxs(\"div\",{className:\"graphiql-container\",children:[/*#__PURE__*/_jsx(GraphiQLExplorer,{schema:schema,query:query,onEdit:this._handleEditQuery,onRunOperation:function onRunOperation(operationName){var _this2$_graphiql;return(_this2$_graphiql=_this2._graphiql)===null||_this2$_graphiql===void 0?void 0:_this2$_graphiql.handleRunQuery(operationName);},explorerIsOpen:this.state.explorerIsOpen,onToggleExplorer:this._handleToggleExplorer}),/*#__PURE__*/_jsx(GraphiQL,{ref:function ref(_ref){return _this2._graphiql=_ref;},fetcher:this.fetch,schema:schema,query:query,onEditQuery:this._handleEditQuery,children:/*#__PURE__*/_jsxs(GraphiQL.Toolbar,{children:[/*#__PURE__*/_jsx(GraphiQL.Button,{onClick:function onClick(){var _this2$_graphiql2;return(_this2$_graphiql2=_this2._graphiql)===null||_this2$_graphiql2===void 0?void 0:_this2$_graphiql2.handlePrettifyQuery();},label:\"Prettify\",title:\"Prettify Query (Shift-Ctrl-P)\"}),/*#__PURE__*/_jsx(GraphiQL.Button,{onClick:function onClick(){var _this2$_graphiql3;return(_this2$_graphiql3=_this2._graphiql)===null||_this2$_graphiql3===void 0?void 0:_this2$_graphiql3.handleToggleHistory();},label:\"History\",title:\"Show History\"}),/*#__PURE__*/_jsx(GraphiQL.Button,{onClick:this._handleToggleExplorer,label:\"Explorer\",title:\"Toggle Explorer\"}),/*#__PURE__*/_jsx(GraphiQL.Button,{onClick:this.toggleAuthModal,label:\"Update Auth\",title:\"Auth Setting\"}),/*#__PURE__*/_jsx(GraphiQL.Menu,{label:\"Auth - \".concat(AUTH_TYPE_TO_NAME[this.state.currentAuthMode],\" \"),title:AUTH_TYPE_TO_NAME[this.state.currentAuthMode],children:authModes.map(function(mode){return/*#__PURE__*/_jsx(GraphiQL.MenuItem,{title:AUTH_TYPE_TO_NAME[mode],label:\"Use: \".concat(AUTH_TYPE_TO_NAME[mode]),onSelect:function onSelect(){return _this2.switchAuthMode(mode);}});})})]})})]})]});}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/home/katesclau/returnmates/amplify-appsync-simulator/amplify-graphiql-explorer/src/App.tsx"],"names":["GraphiQL","GraphiQLExplorer","buildClientSchema","getIntrospectionQuery","parse","React","Component","AuthModal","AUTH_MODE","refreshToken","DEFAULT_COGNITO_JWT_TOKEN","DEFAULT_OIDC_JWT_TOKEN","AUTH_TYPE_TO_NAME","AMAZON_COGNITO_USER_POOLS","API_KEY","OPENID_CONNECT","AWS_IAM","DEFAULT_API_INFO","name","defaultAuthenticationType","authenticationType","additionalAuthenticationProviders","apiKey","LOCAL_STORAGE_KEY_NAMES","cognitoToken","oidcToken","iam","getAPIInfo","fetch","then","response","json","fetcher","params","additionalHeaders","headers","Accept","method","body","JSON","stringify","responseBody","e","DEFAULT_QUERY","App","props","_graphiql","state","schema","query","explorerIsOpen","authModalVisible","apiInfo","currentAuthMode","credentials","cognitoJWTToken","oidcJWTToken","toggleAuthModal","setState","prevState","switchAuthMode","val","_handleInspectOperation","cm","mousePos","parsedQuery","console","error","token","getTokenAt","start","line","ch","end","relevantMousePos","indexFromPos","position","def","definitions","find","definition","loc","log","operationKind","kind","operation","operationName","value","selector","el","document","querySelector","scrollIntoView","_handleEditQuery","_handleToggleExplorer","bind","loadCredentials","introspectionResult","editor","getQueryEditor","setOption","options","extraKeys","data","newState","authMode","window","localStorage","setItem","OIDCToken","IAM","authProviders","possibleAuth","map","auth","includes","getItem","warn","issuers","filter","openIDConnectConfig","Issuer","authModes","authModal","storeCredentials","handleRunQuery","ref","handlePrettifyQuery","handleToggleHistory","mode"],"mappings":"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","sourcesContent":["import GraphiQL from 'graphiql';\nimport GraphiQLExplorer from 'graphiql-explorer';\nimport 'graphiql/graphiql.css';\nimport { buildClientSchema, getIntrospectionQuery, GraphQLSchema, parse } from 'graphql';\nimport React, { Component } from 'react';\nimport 'semantic-ui-css/semantic.min.css';\nimport './App.css';\nimport { AuthModal, AUTH_MODE } from './AuthModal';\nimport { refreshToken } from './utils/jwt';\n\nconst DEFAULT_COGNITO_JWT_TOKEN = `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI3ZDhjYTUyOC00OTMxLTQyNTQtOTI3My1lYTVlZTg1M2YyNzEiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiaXNzIjoiaHR0cHM6Ly9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbS91cy1lYXN0LTFfZmFrZSIsInBob25lX251bWJlcl92ZXJpZmllZCI6dHJ1ZSwiY29nbml0bzp1c2VybmFtZSI6InVzZXIxIiwiYXVkIjoiMmhpZmEwOTZiM2EyNG12bTNwaHNrdWFxaTMiLCJldmVudF9pZCI6ImIxMmEzZTJmLTdhMzYtNDkzYy04NWIzLTIwZDgxOGJkNzhhMSIsInRva2VuX3VzZSI6ImlkIiwiYXV0aF90aW1lIjoxOTc0MjY0NDEyLCJwaG9uZV9udW1iZXIiOiIrMTIwNjIwNjIwMTYiLCJleHAiOjE1NjQyNjgwMTIsImlhdCI6MTU2NDI2NDQxMywiZW1haWwiOiJ1c2VyQGRvbWFpbi5jb20ifQ.wHKY2KIhvWn4zpJ4TZ1vS3zRE9mGWsLY4NCV2Cof17Q`;\nconst DEFAULT_OIDC_JWT_TOKEN = `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJpc3MiOiJodHRwczovL3NvbWUtb2lkYy1wcm92aWRlci9hdXRoIiwicGhvbmVfbnVtYmVyX3ZlcmlmaWVkIjp0cnVlLCJhdWQiOiIyaGlmYTA5NmIzYTI0bXZtM3Boc2t1YXFpMyIsImV2ZW50X2lkIjoiYjEyYTNlMmYtN2EzNi00OTNjLTg1YjMtMjBkODE4YmQ3OGExIiwidG9rZW5fdXNlIjoiaWQiLCJhdXRoX3RpbWUiOjE5NzQyNjQ0MTIsInBob25lX251bWJlciI6IisxMjA2MjA2MjAxNiIsImV4cCI6MTU2NDI2ODAxMiwiaWF0IjoxNTY0MjY0NDEzLCJlbWFpbCI6InVzZXJAZG9tYWluLmNvbSJ9.uAegFXomOnA7Dkl-5FcS5icu5kL9Juqb81GnTrOZZqM`;\n\nconst AUTH_TYPE_TO_NAME = {\n  AMAZON_COGNITO_USER_POOLS: 'User Pool',\n  API_KEY: 'API Key',\n  OPENID_CONNECT: 'Open ID',\n  AWS_IAM: 'IAM',\n};\n\ntype AmplifyAppSyncSimulatorAuthInfo = {\n  authenticationType: string;\n};\ntype AmplifyAppSyncSimulatorApiInfo = {\n  name: string;\n  defaultAuthenticationType: AmplifyAppSyncSimulatorAuthInfo;\n  apiKey: string;\n  additionalAuthenticationProviders: AmplifyAppSyncSimulatorAuthInfo[];\n};\nconst DEFAULT_API_INFO: AmplifyAppSyncSimulatorApiInfo = {\n  name: 'AppSyncTransformer',\n  defaultAuthenticationType: {\n    authenticationType: 'API_KEY',\n  },\n  additionalAuthenticationProviders: [],\n  apiKey: 'da2-fakeApiId123456',\n};\n\nconst LOCAL_STORAGE_KEY_NAMES = {\n  cognitoToken: 'AMPLIFY_GRPAHIQL_EXPLORER_COGNITO_JWT_TOKEN',\n  oidcToken: 'AMPLIFY_GRPAHIQL_EXPLORER_OIDC_JWT_TOKEN',\n  apiKey: 'AMPLIFY_GRPAHIQL_EXPLORER_API_KEY',\n  iam: 'AMPLIFY_GRPAHIQL_EXPLORER_AWS_IAM',\n};\n\nfunction getAPIInfo() {\n  return fetch('/api-config').then(response => response.json());\n}\n\nfunction fetcher(params: Object, additionalHeaders): Promise<any> {\n  const headers = {\n    Accept: 'application/json',\n    'Content-Type': 'application/json',\n    ...additionalHeaders,\n  };\n  return fetch('/graphql', {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(params),\n  })\n    .then(function (response) {\n      return response.json();\n    })\n    .then(function (responseBody) {\n      try {\n        return JSON.parse(responseBody);\n      } catch (e) {\n        return responseBody;\n      }\n    });\n}\n\nconst DEFAULT_QUERY = `# shift-option/alt-click on a query below to jump to it in the explorer\n# option/alt-click on a field in the explorer to select all subfields\n`;\n\ntype State = {\n  schema?: GraphQLSchema | null;\n  query?: string;\n  explorerIsOpen: boolean;\n  authModalVisible: boolean;\n  jwtToken?: string;\n  apiKey?: string;\n  apiInfo: AmplifyAppSyncSimulatorApiInfo;\n  currentAuthMode: AUTH_MODE;\n  credentials: {\n    apiKey?: string;\n    cognitoJWTToken?: string;\n    oidcJWTToken?: string;\n    iam?: string;\n  };\n};\n\nclass App extends Component<{}, State> {\n  _graphiql?: GraphiQL;\n  state: State = {\n    schema: null,\n    query: DEFAULT_QUERY,\n    explorerIsOpen: true,\n    authModalVisible: false,\n    apiInfo: DEFAULT_API_INFO,\n    currentAuthMode: AUTH_MODE.API_KEY,\n    credentials: {\n      apiKey: '',\n      cognitoJWTToken: '',\n      oidcJWTToken: '',\n      iam: '',\n    },\n  };\n\n  constructor(props) {\n    super(props);\n    this.fetch = this.fetch.bind(this);\n  }\n  async componentDidMount() {\n    const apiInfo = await getAPIInfo();\n    this.loadCredentials(apiInfo);\n    this.setState({ apiInfo });\n    const introspectionResult = await this.fetch({\n      query: getIntrospectionQuery(),\n    });\n\n    const editor = this._graphiql?.getQueryEditor();\n    editor.setOption('extraKeys', {\n      ...(editor.options.extraKeys || {}),\n      'Shift-Alt-LeftClick': this._handleInspectOperation,\n    });\n    if (introspectionResult && introspectionResult.data) {\n      this.setState({ schema: buildClientSchema(introspectionResult.data) });\n    }\n  }\n\n  toggleAuthModal = () =>\n    this.setState(prevState => ({\n      authModalVisible: !prevState.authModalVisible,\n    }));\n\n  switchAuthMode = val => {\n    this.setState({ currentAuthMode: val });\n  };\n  _handleInspectOperation = (cm: any, mousePos: { line: Number; ch: Number }) => {\n    const parsedQuery = parse(this.state.query || '');\n\n    if (!parsedQuery) {\n      console.error(\"Couldn't parse query document\");\n      return null;\n    }\n\n    var token = cm.getTokenAt(mousePos);\n    var start = { line: mousePos.line, ch: token.start };\n    var end = { line: mousePos.line, ch: token.end };\n    var relevantMousePos = {\n      start: cm.indexFromPos(start),\n      end: cm.indexFromPos(end),\n    };\n\n    var position = relevantMousePos;\n\n    var def = parsedQuery.definitions.find(definition => {\n      if (!definition.loc) {\n        console.log('Missing location information for definition');\n        return false;\n      }\n\n      const { start, end } = definition.loc;\n      return start <= position.start && end >= position.end;\n    });\n\n    if (!def) {\n      console.error(`Unable to find definition corresponding position at ${position.start}`);\n      return null;\n    }\n\n    var operationKind = def.kind === 'OperationDefinition' ? def.operation : def.kind === 'FragmentDefinition' ? 'fragment' : 'unknown';\n\n    var operationName =\n      def.kind === 'OperationDefinition' && !!def.name\n        ? def.name.value\n        : def.kind === 'FragmentDefinition' && !!def.name\n        ? def.name.value\n        : 'unknown';\n\n    var selector = `.graphiql-explorer-root #${operationKind}-${operationName}`;\n\n    var el = document.querySelector(selector);\n    el && el.scrollIntoView();\n  };\n\n  _handleEditQuery = (query: string | undefined): void => this.setState({ query });\n\n  _handleToggleExplorer = () => {\n    this.setState({ explorerIsOpen: !this.state.explorerIsOpen });\n  };\n\n  fetch(params) {\n    const headers = {};\n    if (this.state.currentAuthMode === AUTH_MODE.API_KEY) {\n      headers['x-api-key'] = this.state.credentials.apiKey;\n    } else if (this.state.currentAuthMode === AUTH_MODE.AMAZON_COGNITO_USER_POOLS) {\n      headers['Authorization'] = this.state.credentials.cognitoJWTToken;\n    } else if (this.state.currentAuthMode === AUTH_MODE.OPENID_CONNECT) {\n      headers['Authorization'] = this.state.credentials.oidcJWTToken;\n    } else if (this.state.currentAuthMode === AUTH_MODE.AWS_IAM) {\n      headers['Authorization'] = this.state.credentials.iam;\n    }\n    return fetcher(params, headers);\n  }\n\n  storeCredentials(credentials) {\n    const apiInfo = this.state.apiInfo;\n    const newState = {\n      apiInfo: { ...apiInfo, authenticationType: credentials.authMode },\n    };\n    if (credentials.authMode === 'API_KEY') {\n      newState['apiKey'] = credentials.apiKey;\n      window.localStorage.setItem(LOCAL_STORAGE_KEY_NAMES.apiKey, credentials.apiKey);\n    } else if (credentials.authMode === AUTH_MODE.AMAZON_COGNITO_USER_POOLS) {\n      newState['cognitoJWTToken'] = credentials.cognitoToken;\n      window.localStorage.setItem(LOCAL_STORAGE_KEY_NAMES.cognitoToken, credentials.cognitoToken);\n    } else if (credentials.authMode === AUTH_MODE.OPENID_CONNECT) {\n      newState['oidcJWTToken'] = credentials.OIDCToken;\n      window.localStorage.setItem(LOCAL_STORAGE_KEY_NAMES.oidcToken, credentials.OIDCToken);\n    } else if (credentials.authMode === AUTH_MODE.AWS_IAM) {\n      newState['oidcJWTToken'] = credentials.IAM;\n      window.localStorage.setItem(LOCAL_STORAGE_KEY_NAMES.iam, credentials.iam);\n    }\n    this.setState(prevState => ({\n      credentials: {\n        ...prevState.credentials,\n        ...newState,\n      },\n      currentAuthMode: credentials.authMode,\n    }));\n  }\n\n  loadCredentials(apiInfo = this.state.apiInfo) {\n    const credentials = {};\n    const authProviders = [apiInfo.defaultAuthenticationType, ...apiInfo.additionalAuthenticationProviders];\n    const possibleAuth = authProviders.map(auth => auth.authenticationType);\n\n    if (possibleAuth.includes('API_KEY')) {\n      credentials['apiKey'] = DEFAULT_API_INFO.apiKey;\n    }\n\n    if (possibleAuth.includes('AMAZON_COGNITO_USER_POOLS')) {\n      try {\n        credentials['cognitoJWTToken'] = refreshToken(window.localStorage.getItem(LOCAL_STORAGE_KEY_NAMES.cognitoToken) || '');\n      } catch (e) {\n        console.warn('Invalid Cognito token found in local storage. Using the default OIDC token');\n        // token is not valid\n        credentials['cognitoJWTToken'] = refreshToken(DEFAULT_COGNITO_JWT_TOKEN);\n      }\n    }\n\n    if (possibleAuth.includes('OPENID_CONNECT')) {\n      const issuers = authProviders\n        .filter(auth => auth.authenticationType === AUTH_MODE.OPENID_CONNECT)\n        .map((auth: any) => auth.openIDConnectConfig.Issuer);\n      try {\n        credentials['oidcJWTToken'] = refreshToken(window.localStorage.getItem(LOCAL_STORAGE_KEY_NAMES.oidcToken) || '', issuers[0]);\n      } catch (e) {\n        console.warn('Invalid OIDC token found in local storage. Using the default OIDC token');\n        credentials['oidcJWTToken'] = refreshToken(DEFAULT_OIDC_JWT_TOKEN, issuers[0]);\n      }\n    }\n\n    if (possibleAuth.includes('AWS_IAM')) {\n      credentials['iam'] = 'AWS4-HMAC-SHA256 IAMAuthorized';\n    }\n\n    this.setState(() => ({\n      currentAuthMode: AUTH_MODE[apiInfo.defaultAuthenticationType.authenticationType] || AUTH_MODE.API_KEY,\n    }));\n    this.setState({ credentials });\n    return credentials;\n  }\n\n  render() {\n    const { query, schema, authModalVisible, apiInfo } = this.state;\n    const authModes = [\n      AUTH_MODE[apiInfo.defaultAuthenticationType.authenticationType],\n      ...apiInfo.additionalAuthenticationProviders.map(auth => AUTH_MODE[auth.authenticationType]),\n    ].filter(auth => auth);\n    const authModal = authModalVisible ? (\n      <AuthModal\n        selectedAuthMode={this.state.currentAuthMode}\n        currentOIDCToken={this.state.credentials.oidcJWTToken}\n        currentCognitoToken={this.state.credentials.cognitoJWTToken}\n        apiKey={this.state.credentials.apiKey}\n        authModes={authModes}\n        onClose={credentials => {\n          this.storeCredentials(credentials);\n          this.setState({ authModalVisible: false });\n        }}\n      />\n    ) : null;\n    return (\n      <>\n        {authModal}\n        <div className='graphiql-container'>\n          <GraphiQLExplorer\n            schema={schema}\n            query={query}\n            onEdit={this._handleEditQuery}\n            onRunOperation={operationName => this._graphiql?.handleRunQuery(operationName)}\n            explorerIsOpen={this.state.explorerIsOpen}\n            onToggleExplorer={this._handleToggleExplorer}\n          />\n          <GraphiQL\n            ref={ref => (this._graphiql = ref as GraphiQL)}\n            fetcher={this.fetch}\n            schema={schema!}\n            query={query}\n            onEditQuery={this._handleEditQuery}\n          >\n            <GraphiQL.Toolbar>\n              <GraphiQL.Button\n                onClick={() => this._graphiql?.handlePrettifyQuery()}\n                label='Prettify'\n                title='Prettify Query (Shift-Ctrl-P)'\n              />\n              <GraphiQL.Button onClick={() => this._graphiql?.handleToggleHistory()} label='History' title='Show History' />\n              <GraphiQL.Button onClick={this._handleToggleExplorer} label='Explorer' title='Toggle Explorer' />\n              <GraphiQL.Button onClick={this.toggleAuthModal} label='Update Auth' title='Auth Setting' />\n              <GraphiQL.Menu\n                label={`Auth - ${AUTH_TYPE_TO_NAME[this.state.currentAuthMode]} `}\n                title={AUTH_TYPE_TO_NAME[this.state.currentAuthMode]}\n              >\n                {authModes.map(mode => (\n                  <GraphiQL.MenuItem\n                    title={AUTH_TYPE_TO_NAME[mode]}\n                    label={`Use: ${AUTH_TYPE_TO_NAME[mode]}`}\n                    onSelect={() => this.switchAuthMode(mode)}\n                  />\n                ))}\n              </GraphiQL.Menu>\n            </GraphiQL.Toolbar>\n          </GraphiQL>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}